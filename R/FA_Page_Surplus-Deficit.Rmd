---

---

## Surplus / Deficit

```{r}


FA_Data_District %>%
  ungroup() %>% 
  filter(FY != fiscal.year) %>% 
  select(FY, fid.surplus.deficit, 
         db.orig.surplus.deficit) %>%
  flextable() %>%
  set_header_labels(FY = "Fiscal Year",
                    fid.surplus.deficit = "Actual Surplus/Deficit",
                    db.orig.surplus.deficit = "Original Budget Surplus/Deficit") %>%
  colformat_num(j = "FY",
                big.mark = "") %>%
  colformat_double(j = c("fid.surplus.deficit",
                         "db.orig.surplus.deficit"),
                   big.mark = ",",
                   digits = 0) %>%
  bg(j = "fid.surplus.deficit", bg = "#d1e8fa", part = "all") %>%
  bg(j = "db.orig.surplus.deficit", bg = "#fad1db", part = "all") %>% 

  flextable_custom_theme()



  # df %>%
  # autofit(part = "body") %>%
  #   theme_vanilla()
  


```


```{r}
# 
# 
#   select(FY, fid.surplus.deficit, 
#          db.orig.surplus.deficit, db.final.surplus.deficit) %>%
# 

FA_Data_District %>%
  ggplot(aes(x = FY)) +
  geom_col(aes(y = fid.surplus.deficit), 
           fill = mea_blue,
           width = .25,
           just = 1)+
  geom_col(aes(y = db.orig.surplus.deficit),
           fill = mea_red,
           width = .25,
           just = 0) +
  geom_hline(yintercept = 0)+
  scale_x_continuous(breaks = seq(1990, 2100, by = 1) )+
  scale_y_continuous(labels = number_format(big.mark = ",")) +
  labs(title = "<span style='color: #003057'> Actual</span> and <span style='color: #C2002F'> Original Budget</span> Surplus/Deficit",
       x = "Fiscal Year",
       y = "") +
  theme(
    plot.title = element_markdown()
  )

```


